[TOC]

# 3.3  Verilog HDL数据流建模与运算符

- 对于基本单元逻辑电路，使用Verilog语言提供的门级元件模型描述电路非常方便。 
- 但随着电路复杂性的增加，使用的逻辑门较多时，使用HDL门级描述的工作效率就很低。
- 数据流建模能够在较高的抽象级别描述电路的逻辑功能，并且通过逻辑综合软件，能够自动地将数据流描述转换成为门级电路。 
- 数据流建模主要使用逻辑表达式，所以要了解各种运算符和表达式。

## 3.3.1 数据流建模

数据流建模使用的连续赋值语句，由关键词assign开始，后面跟着由操作数和运算符等组成的逻辑表达式。

一般用法

```verilog
wire [位宽说明]变量名1，变量名2,...,变量名n;
assign 变量名=表达式
```

注：

assign 语句只能对wire型变量进行赋值，所以等号左边变量名的数据类型必须是wire型。

- 举例

$$
Y=D_0\cdot \overline{S}+D_1 \cdot S
$$

<img src="https://mypic-1312707183.cos.ap-nanjing.myqcloud.com/image-20221002191409554.png" alt="image-20221002191409554" style="zoom: 67%;" />

```verilog
module mux2to1_dataflow(D0, D1, S, Y );
  input D0, D1, S;  
  output Y;
  wire Y ; 

//下面是逻辑功能描述
  assign Y = (~S & D0) | (S & D1);  //表达式左边Y必须是wire型

endmodule                       

```

## 3.3.2  运算符及其优先级

### 运算符

共9类

| 运算符分类         | 所含运算符                                                   |
| ------------------ | ------------------------------------------------------------ |
| 算术运算符         | $+\quad \quad -\quad \quad *\quad \quad /\quad \quad %$      |
| 位运算符           | $\sim \quad \quad\& \quad\quad \wedge \quad\quad \wedge \sim 或\sim \wedge$ |
| 缩位运算符(单目）  | $\&　\quad\quad \sim \& \quad\quad | \quad\quad \sim | \quad\quad \wedge \quad\quad \wedge \sim 或\sim \wedge$ |
| 逻辑运算符         | $! \quad\quad \&\& \quad\quad \|$                            |
| 关系运算符（双目） | $< \quad\quad > \quad\quad <= \quad\quad >=$                 |
| 相等与全等运算符   | $== \quad\quad != \quad\quad === \quad\quad!==$              |
| 逻辑移位运算符     | $<< \quad\quad >>$                                           |
| 位拼接运算符       | $\{\}$                                                       |
| 条件运算符         | $?:$                                                         |

### 位拼接运算符

作用是将两个或多个信号的某些位拼接起来成为一个新的操作数，进行运算操作。

设A=1’b1，B=2’b10，C=2’b00

则
$$
\{B,C\}＝4’b1000\\
\{A,B[1],C[0]\}＝3’b110\\
\{A,B,C,3’b101\}=8’b11000101\\
$$
对同一个操作数的重复拼接还可以双重大括号构成的运算符{{}}

如
$$
\{4\{A\}\}=4’b1111\\
\{2\{A\},2\{B\},C\}=8’b11101000
$$

### 位运算符与缩位运算的比较

设A：4’b1010 、B：4’b1111

| 位运算结果              | 缩位运算结果     |
| ----------------------- | ---------------- |
| ~A = 0101<br/>~B = 0000 | &A=1&0&1&0=0     |
| A&B=1010                | ~&A=1<br/>&B=1   |
| A\|B=1111               | \|A=1<br/>~\|B=0 |
| A^B=0101                | ^A=0<br/>^B=0    |
| A~^B=1010               | ~^A=1<br/>~^B=1  |

### 相等与全等运算符

有四种：

＝＝（逻辑相等），    !＝（逻辑不等）
＝＝＝（条件全等），!＝＝（条件不全等） 

a、b的初值同为4‘b0100，c和d的初值同为4’b10x0

| a==b     | a!=b     | a===b     | a!==b     |
| -------- | -------- | --------- | --------- |
| **1**    | **0**    | **1**     | **0**     |
| **c==d** | **c!=d** | **c===d** | **c!==d** |
| **x**    | **x**    | **1**     | **0**     |

### 条件运算符

是三目运算符，运算时根据条件表达式的值选择表达式。

一般用法

```verilog
condition_expr?expr1:expr2;
```

首先计算第一个操作数condition_expr的值，如果结果为逻辑1，则选择第二个操作数expr1的值作为结果返回，结果为逻辑0，选择第三个操作数expr2的值作为结果返回。

### 运算符的优先级

| **类型** | **符号**                           |
| -------- | ---------------------------------- |
| **取反** | ! ~ -(求2的补码)                   |
| **算术** | *** /**  **+   -**                 |
| **移位** | **>> <<**                          |
| **关系** | **< <= >   >=**                    |
| **等于** | **== !=**                          |
| **缩位** | **& ~&**  **^   ^~**  **\|   ~\|** |
| **逻辑** | **&&**  **\|\|**                   |
| **条件** | **?:**                             |